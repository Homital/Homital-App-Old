(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-dashboard-dashboard"],{"0dbd":function(e,t,n){function a(e){var t=e.map((function(e){var t=new Date(e.date);return{date:t,day:r(t.getDay()),usage:e.usage}}));t.sort((function(e,t){return e.date-t.date}));for(var n={type:"bar",data:{labels:["Mon","Tue","Wed","Thu","Fri","Sat","Today"],datasets:[{data:[240,245,200,150,280,400,234],backgroundColor:"rgba(54, 162, 235, 0.5)"}]},options:{responsive:!0,legend:{display:!1},scales:{xAxes:[{gridLines:{display:!1}}],yAxes:[{gridLines:{display:!0},ticks:{beginAtZero:!0,stepSize:100}}]}}},a=0,o=e.length-7>=0?e.length-7:0;o<e.length;o++)n.data.labels[a]=t[o].day,n.data.datasets[0].data[a++]=t[o].usage;var s=JSON.stringify(n),i="https://quickchart.io/chart?bkg=white&c=".concat(s);return i}function r(e){var t;switch(e){case 0:t="Sun";break;case 1:t="Mon";break;case 2:t="Tue";break;case 3:t="Wed";break;case 4:t="Thu";break;case 5:t="Fri";break;case 6:t="Sat"}return t}n("d81d"),n("4e82"),e.exports=a},"47a0":function(e,t,n){"use strict";n.r(t);var a=n("ea0bf"),r=n.n(a);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);t["default"]=r.a},"54d6":function(e,t,n){"use strict";n.r(t);var a=n("be3f"),r=n("47a0");for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var s,i=n("f0c5"),c=Object(i["a"])(r["default"],a["b"],a["c"],!1,null,"b28cf472",null,!1,a["a"],s);t["default"]=c.exports},be3f:function(e,t,n){"use strict";var a;n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a}));var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"page"},[n("v-uni-view",{staticClass:"image-list"},[n("v-uni-view",{staticClass:"image-item",attrs:{src:e.imageUrl}},[n("v-uni-view",{staticClass:"image-content"},[e.imageUrl?n("v-uni-image",{staticStyle:{"background-color":"#eeeeee",width:"100%"},attrs:{mode:"scaleToFill",src:e.imageUrl},on:{error:function(t){arguments[0]=t=e.$handleEvent(t),e.imageError.apply(void 0,arguments)}}}):e._e()],1),n("v-uni-view",{staticClass:"image-title"},[e._v("Device usage")])],1)],1)],1)},o=[]},c973:function(e,t,n){function a(e,t,n,a,r,o,s){try{var i=e[o](s),c=i.value}catch(u){return void n(u)}i.done?t(c):Promise.resolve(c).then(a,r)}function r(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var s=e.apply(t,n);function i(e){a(s,r,o,i,c,"next",e)}function c(e){a(s,r,o,i,c,"throw",e)}i(void 0)}))}}n("d3b7"),n("e6cf"),e.exports=r},ea0bf:function(e,t,n){"use strict";var a=n("4ea4");n("99af"),n("fb6a"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("96cf");var r=a(n("1da1")),o=n("0dbd"),s=n("eb11"),i={data:function(){return{imageUrl:"",deviceName:"",roomId:"",array:[{mode:"scaleToFill",text:"scaleToFill：不保持纵横比缩放图片，使图片完全适应"},{mode:"aspectFit",text:"aspectFit：保持纵横比缩放图片，使图片的长边能完全显示出来"},{mode:"aspectFill",text:"aspectFill：保持纵横比缩放图片，只保证图片的短边能完全显示出来"}],src:"https://img-cdn-qiniu.dcloud.net.cn/uniapp/images/shuijiao.jpg"}},onShow:function(){var e=this;return(0,r.default)(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=e,e.deviceName=getApp().globalData.device_switched_to,e.roomId=getApp().globalData.room_switched_to_id,a=getApp().globalData.base_url+"/user/data/?uid=".concat(e.roomId,"&devicename=").concat(e.deviceName,"&demo=true"),s.functions.makeAuthenticatedCall(function(){var e=(0,r.default)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log("reached get user statistics"),200==t.statusCode?(console.log("successfully obtain user statistics for user: "+n.username),uni.downloadFile({url:"http://"+o(t.data).slice(8),success:function(e){n.imageUrl=e.tempFilePath,console.log(n.imageUrl)}})):uni.showToast({icon:"none",title:t.data.error,duration:2e3});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a,{},"GET");case 5:case"end":return t.stop()}}),t)})))()},methods:{imageError:function(e){console.error("image发生error事件，携带值为"+e.detail.errMsg)}}};t.default=i},eb11:function(e,t,n){n("96cf");var a=n("c973");function r(e){o(e,1)}function o(e,t){return s.apply(this,arguments)}function s(){return s=a(regeneratorRuntime.mark((function e(t,n){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=getApp().globalData.refresh_token,e.next=3,uni.request({url:getApp().globalData.base_url+"/auth/user/token",data:{refresh_token:a},method:"POST",header:{"content-type":"application/json"},success:function(e){return 200==e.statusCode?(console.log("reached1"),console.log("printing access token when first saved :"+e.data.access_token),getApp().globalData.access_token=e.data.access_token,console.log("printing again after saved : "+getApp().globalData.access_token),t(!0),!0):(console.log("failed to get access token in 1 attempt, let's try again"),n>0?void o(t,n-1):(t(!1),!1))},fail:function(e){if(console.log("failed to get access token in 1 attempt, let's try again"),!(n>0))return t(!1),!1;o(t,n-1)}});case 3:case"end":return e.stop()}}),e)}))),s.apply(this,arguments)}function i(e,t,n,a){return c.apply(this,arguments)}function c(){return c=a(regeneratorRuntime.mark((function e(t,n,a,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:u(t,n,a,r,1);case 1:case"end":return e.stop()}}),e)}))),c.apply(this,arguments)}function u(e,t,n,a,r){return l.apply(this,arguments)}function l(){return l=a(regeneratorRuntime.mark((function e(t,n,o,s,i){var c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,getApp().globalData.access_token;case 2:return c=e.sent,console.log("printing access token before request: "+c),e.next=6,uni.request({url:n,data:o,method:s,header:{Authorization:"Bearer "+c},success:function(){var e=a(regeneratorRuntime.mark((function e(c){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(200!=c.statusCode){e.next=5;break}console.log("request sent suc : true"),t(c),e.next=14;break;case 5:if(console.log("request sent suc : false"),!(i>0)){e.next=12;break}return console.log("ok access token was not ok, let's try again"),e.next=10,r(function(){var e=a(regeneratorRuntime.mark((function e(a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!a){e.next=5;break}console.log("A new access token gotten, making second request"),u(t,n,o,s,i-1),e.next=12;break;case 5:return e.next=7,uni.showToast({icon:"none",title:"Your token has already expired. Please log in again.",duration:2e3});case 7:getApp().globalData.notloggedin=!0,getApp().globalData.refresh_token="",uni.removeStorageSync("userinfo"),t(c),console.log("cannot get access token in 2 attempts, prompt user to log in again for a new refresh_token");case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 10:e.next=14;break;case 12:t(c),console.log("request not successful after 2 attempts");case 14:case"end":return e.stop()}}),e)})));function c(t){return e.apply(this,arguments)}return c}(),fail:function(){var e=a(regeneratorRuntime.mark((function e(a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log("no response received"),console.log("may have gotten empty response, let's retry"),u(t,n,o,s,i-1);case 3:case"end":return e.stop()}}),e)})));function r(t){return e.apply(this,arguments)}return r}()});case 6:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}e.exports={functions:{requestAcessToken:r,makeAuthenticatedCall:i}}}}]);